FUNCTION_BLOCK "SetGate1Input"
TITLE = Imposta stato delle variabili relative alle porte
{ S7_Optimized_Access := 'TRUE' }
AUTHOR : Nicola
VERSION : 0.1
//Carico lo stato delle variabili porte
   VAR_OUTPUT 
      GtIsClosed : Bool;
      Msg : String := '';
   END_VAR


BEGIN
	// Carico i dati del letti dalle TAG nel DB 
	"InputData".Gt1IsClosed := "Prox1";
	"InputData".Gt2IsClosed := "Prox2";
	"InputData".Gt3IsClosed := "Prox3";
	#Msg := 'Waiting Status';
	// Stato porta 1 - Messaggio per lettura semplificata
	IF "InputData".Gt1IsClosed THEN
	    #Msg := 'Porta 1 chiusa';
	    "Appo".Gt1St.%X0 := 1;
	ELSE
	    #Msg := 'Porta 1 aperta';
	    "Appo".Gt1St.%X0 := 0;
	END_IF;
	// Stato porta 2
	IF "InputData".Gt2IsClosed THEN
	    #Msg := CONCAT(IN1 := #Msg, IN2 := ' - Porta 2 chiusa');
	    "Appo".Gt1St.%X1 := 1;
	ELSE
	    #Msg := CONCAT(IN1 := #Msg, IN2 := ' - Porta 2 aperta');
	    "Appo".Gt1St.%X1 := 0;
	END_IF;
	// Stato porta 3
	IF "InputData".Gt3IsClosed THEN
	    #Msg := CONCAT(IN1 := #Msg, IN2 := ' - Porta 3 chiusa');
	    "Appo".Gt1St.%X2 := 1;
	ELSE
	    #Msg := CONCAT(IN1 := #Msg, IN2 := ' - Porta 3 aperta');
	    //"Appo".Gt1St.%X2 := 0;
	END_IF;
	
	// Cumulativo
	#GtIsClosed := "InputData".Gt1IsClosed AND "InputData".Gt2IsClosed AND "InputData".Gt3IsClosed;
	
	
END_FUNCTION_BLOCK

